<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{_layout :: header( ~{::title}, _, _ )}">

    <title>Accueil PK</title>
</head>

<body>

    <nav th:replace="~{_layout :: menu}"></nav>
    <div class="container">
        <h1>En boutique aujourd'hui <i class="fa-solid fa-kiwi-bird fa-spin-pulse"></i></h1>

        <div>
            <form th:action="@{/produits}" method="GET">
                <div class="form-group">
                    <label for="size">Produits par page :</label>
                    <select name="s" id="size" class="form-control" onchange="this.form.submit()">
                        <option value="5" th:selected="${page.size==5}">5</option>
                        <option value="10" th:selected="${page.size==10}">10</option>
                        <option value="20" th:selected="${page.size==20}">20</option>
                    </select>
                </div>
                <!--- ajout "eventuel" hidden "p" pour conserver la page-->
            </form>

            <form th:action="@{/produits}" method="GET">
                <input type="hidden" name="s" th:value="${page.size}" />
                <div class="input-group">
                    <input type="text" name="mc" id="mc" th:value="${motCle}" class="form-control">
                    <button class="btn btn-primary" type="submit">Rechercher</button>
                </div>

        
            </form>
        </div>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col">Nom</th>
                    <th scope="col">Prix</th>
                    <th scope="col">Quantit√©</th>
                    <th scope="col">Edit/Delete</th>
                </tr>
            </thead>
            <tbody>
                <tr class="table-secondary" th:each="p : ${produits}">
                    <td th:text="${p.nom}"></td>
                    <td th:text="${#numbers.formatDecimal(p.prix,2 ,2, 'COMMA') + ' &euro;'}"></td>
                    <td th:text="${p.quantite<=0 ? 'non disponible' : p.quantite}"></td>
                    <td>
                        <a href="#" class="btn btn-primary"><i class="fa-regular fa-pen-to-square"></i></a>
                        <a href="#" class="btn btn-danger"><i class="fa-regular fa-trash-can"></i></a>
                    </td>
                </tr>
            </tbody>
        </table>
        <div>
            <ul class="pagination pagination-sm">
                <li class="page-item" th:classappend="${page.number==0} ? 'disabled' : ''">
                    <a class="page-link" th:href="@{/produits(p=${page.number-1}, s=${page.size}, mc=${motCle})}">&laquo;</a>
                </li>
                <li class="page-item active" th:classappend="${i==page.number+1} ? 'active' : ''"
                    th:each="i : ${#numbers.sequence(1,page.totalPages)}">
                    <a class="page-link" th:href="@{/produits(p=${i-1}, s=${page.size}, mc=${motCle})}" th:text="${i}"></a>
                </li>
                <li class="page-item" th:classappend="${page.last} ? 'disabled' : ''">
                    <a class="page-link" th:href="@{/produits(p=${page.number+1}, s=${page.size}, mc=${motCle})}">&raquo;</a>
                </li>
            </ul>
        </div>
    </div>
</body>

</html>